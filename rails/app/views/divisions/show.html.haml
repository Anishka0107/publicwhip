%h1= @short_title
/ the second tier navigation as tabs
:plain
  <!-- add hashes to $second_links array, keys are
       'href' - URL of link
       'text' - displayed text
       'tooltip' - text to put in title
       'current' - 'on' or 'off' for whether this item is currently selected -->
.secondnavtabs
  %ul
    %li.on Summary
    %li.off
      = link_to "All voters", division_path(params.merge(display: "allvotes")), title: "Every MP who cast a vote in the division", class: "off"
    %li.off
      = link_to "One view", division_path(params.merge(display: "slab")), title: "Show all votes as one compressed table", class: "off"
    %li.off
      = link_to "All eligible voters", division_path(params.merge(display: "allpossible")), title: "Show even MPs who did not vote but could have", class: "off"
    %li.off
      = link_to "Similar Divisions", division_path(params.merge(display: "similardivisionsparl")), title: "Show all divisions in order of similarity of vote in this Parliament", class: "off"
    %li.off
      = link_to "Policies", division_path(params.merge(display: "policies")), title: "Show or change the polices which vote on this division", class: "off"
<!-- the second tier navigation as dropdowns end-->
.motion
  %p
    %strong
      Description automatically extracted from the debate,
      please
      = link_to "edit it", "account/wiki.php?type=motion&date=2013-03-14&number=1&house=representatives&rr=%2Fdivision.php%3Fdate%3D2013-03-14%26number%3D1%26house%3Drepresentatives"
      to make it better.
  -# The motion can include html.
  -# TODO Need to check what happens when the user edits the motion. What can they add?
  = raw @division.motion
  %p
    %b
      = link_to "Debate in Parliament", @division.oa_debate_url, title: "Links to debate shown at www.openaustralia.org"
    |
    %b
      = link_to "Source", @division.source_url, title: "The original record of vote as reported by Hansard"
    |
    %b
      = link_to "Edit", "account/wiki.php?type=motion&date=2013-03-14&number=1&house=representatives&rr=%2Fdivision.php%3Fdate%3D2013-03-14%26number%3D1%26house%3Drepresentatives", title: "Edit and improve this description"
    (#{link_to "learn more", "faq.php#motionedit"})
%h2
  %a{:name => "summary"} Party Summary
%p
  Votes by party, red entries are votes against the majority for that party.
.tableexplain
  %p
    %span.ptitle What is Tell?
    '+1 tell' means that in addition one member of that party was a
    = link_to "teller", "faq.php#jargon"
    for that division lobby.
  %span.ptitle What is Turnout?
  This is measured against the total membership of the party at the time of the vote.
%table
  %tr.headings
    %td Party
    %td Majority (#{@division.majority_type.capitalize})
    %td Minority (#{@division.minority_type.capitalize})
    %td Turnout
  - @division.whips.order(:party).each do |whip|
    -# Don't shown parties that haven't voted in this division
    - if whip.total_votes > 0
      %tr.odd
        %td= whip.party_name
        %td{:class => majority_vote_class(whip)}= whip.majority_votes_including_tells
        %td{:class => minority_vote_class(whip)}= whip.minority_votes_including_tells
        %td.percent= whip.attendance_percentage
  %tr.even
    %td.whip Total:
    %td{:class => majority_vote_total_class(@division)}= @division.majority_votes_including_tells
    %td{:class => minority_vote_total_class(@division)}= @division.minority_votes_including_tells
    %td.percent= @division.attendance_percentage
%h2
  %a{:name => "votes"} Rebel Voters - sorted by party
%p
  Representatives for which their vote in this division differed
  from the majority vote of their party. You can see
  = link_to "all votes", division_path(params.merge(display: "allvotes"))
  in this division, or
  = link_to "every eligible Representative", division_path(params.merge(display: "allpossible"))
  who could have voted in this division
%p{:align => "center", :style => "font-size: 89%"}
  Sort by:
  = link_to "Name", division_path(params.merge(sort: "name"))
  |
  = link_to "Constituency", division_path(params.merge(sort: "constituency"))
  |
  %b Party
  |
  = link_to "Vote", division_path(params.merge(sort: "vote"))
%table#votetable.votes
  %tr.headings
    %td Name
    %td Electorate
    %td Party
    %td Vote
  %tr.even
    %td{:colspan => "4"} no rebellions
